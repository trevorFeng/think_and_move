### CAP
- 一致性
- 可用性
- 分区容错性

### 二阶段提交
- 投票阶段
    - 协调者节点向所有参与者节点询问是否可以执行提交操作(vote)，并开始等待各参与者节点的响应
    - 参与者节点执行询问发起为止的所有事务操作，并将Undo信息和Redo信息写入日志。（注意：若成功这里其实每个参与者已经执行了事务操作）
    - 各参与者节点响应协调者节点发起的询问。如果参与者节点的事务操作实际执行成功，则它返回一个同意消息；如果参与者节点的事务操作实际执行失败，则它返回一个中止消息
- 提交阶段  
如果协调者收到了参与者的失败消息或者超时，直接给每个参与者发送回滚(Rollback)消息；否则，发送提交(Commit)消息；参与者根据协调者的指令执行提交或者回滚操作，释放所有事务处理过程中使用的锁资源。(注意:必须在最后阶段释放锁资源)
接下来分两种情况分别讨论提交阶段的过程：
    -  当协调者节点从所有参与者节点获得的相应消息都为同意时:
        - 协调者节点向所有参与者节点发出正式提交(commit)的请求
        - 参与者节点正式完成操作，并释放在整个事务期间内占用的资源
        - 参与者节点向协调者节点发送完成消息
        - 协调者节点受到所有参与者节点反馈的完成消息后，完成事务
    - 如果任一参与者节点在第一阶段返回的响应消息为中止，或者 协调者节点在第一阶段的询问超时之前无法获取所有参与者节点的响应消息时：
        - 协调者节点向所有参与者节点发出回滚操作(rollback)的请求
        - 参与者节点利用之前写入的Undo信息执行回滚，并释放在整个事务期间内占用的资源
        - 参与者节点向协调者节点发送回滚完成消息
        - 协调者节点受到所有参与者节点反馈的回滚完成消息后，取消事务
    